#general:
#    build_dir: koordinates
#machine:
#    python:
#        version: 2.7.9
#test:
#    override:
#        - python setup.py test
machine:
  python:
    version: 3.4.2

dependencies:
  pre:
    - if [ $CIRCLE_NODE_INDEX == "1" ] ; then pyenv global 2.7.9 ; fi

test:
  pre:
    - mkdir -p ${CIRCLE_TEST_REPORTS}/junit ${CIRCLE_ARTIFACTS}/coverage
  override:
    - >
      nosetests
      --verbose
      --cover-package=koordinates
      --cover-html
      --cover-html-dir=${CIRCLE_ARTIFACTS}/coverage/
      --with-xunit
      --xunit-file=${CIRCLE_TEST_REPORTS}/junit/py$(pyenv global | awk -F. '{print $1$2}').xml:
          parallel: true
